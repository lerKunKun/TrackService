<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.logistics.track17.mapper.CarrierMapper">

    <resultMap id="BaseResultMap" type="com.logistics.track17.entity.Carrier">
        <id column="id" property="id"/>
        <result column="carrier_id" property="carrierId"/>
        <result column="carrier_code" property="carrierCode"/>
        <result column="carrier_name" property="carrierName"/>
        <result column="carrier_name_cn" property="carrierNameCn"/>
        <result column="country_id" property="countryId"/>
        <result column="country_iso" property="countryIso"/>
        <result column="email" property="email"/>
        <result column="tel" property="tel"/>
        <result column="url" property="url"/>
        <result column="is_active" property="isActive"/>
        <result column="sort_order" property="sortOrder"/>
        <result column="created_at" property="createdAt"/>
        <result column="updated_at" property="updatedAt"/>
    </resultMap>

    <select id="selectByCarrierId" resultMap="BaseResultMap">
        SELECT * FROM carriers WHERE carrier_id = #{carrierId}
    </select>

    <select id="selectByCarrierCode" resultMap="BaseResultMap">
        SELECT * FROM carriers WHERE carrier_code = #{carrierCode}
    </select>

    <select id="selectAllActive" resultMap="BaseResultMap">
        SELECT * FROM carriers WHERE is_active = 1 ORDER BY sort_order, carrier_name
    </select>

    <select id="selectAll" resultMap="BaseResultMap">
        SELECT * FROM carriers ORDER BY sort_order, carrier_name
    </select>

    <insert id="insert" parameterType="com.logistics.track17.entity.Carrier" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO carriers (carrier_id, carrier_code, carrier_name, carrier_name_cn,
                             country_id, country_iso, email, tel, url, is_active, sort_order)
        VALUES (#{carrierId}, #{carrierCode}, #{carrierName}, #{carrierNameCn},
                #{countryId}, #{countryIso}, #{email}, #{tel}, #{url}, #{isActive}, #{sortOrder})
    </insert>

    <insert id="batchInsert">
        INSERT INTO carriers (carrier_id, carrier_code, carrier_name, carrier_name_cn,
                             country_id, country_iso, email, tel, url, is_active, sort_order)
        VALUES
        <foreach collection="carriers" item="item" separator=",">
            (#{item.carrierId}, #{item.carrierCode}, #{item.carrierName}, #{item.carrierNameCn},
             #{item.countryId}, #{item.countryIso}, #{item.email}, #{item.tel}, #{item.url}, #{item.isActive}, #{item.sortOrder})
        </foreach>
    </insert>

    <update id="update" parameterType="com.logistics.track17.entity.Carrier">
        UPDATE carriers
        <set>
            <if test="carrierCode != null">carrier_code = #{carrierCode},</if>
            <if test="carrierName != null">carrier_name = #{carrierName},</if>
            <if test="carrierNameCn != null">carrier_name_cn = #{carrierNameCn},</if>
            <if test="countryId != null">country_id = #{countryId},</if>
            <if test="countryIso != null">country_iso = #{countryIso},</if>
            <if test="email != null">email = #{email},</if>
            <if test="tel != null">tel = #{tel},</if>
            <if test="url != null">url = #{url},</if>
            <if test="isActive != null">is_active = #{isActive},</if>
            <if test="sortOrder != null">sort_order = #{sortOrder},</if>
        </set>
        WHERE id = #{id}
    </update>

    <delete id="deleteById">
        DELETE FROM carriers WHERE id = #{id}
    </delete>

</mapper>
